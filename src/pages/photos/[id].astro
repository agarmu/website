---
import { getCollection } from "astro:content";
import Layout from "../../components/layout.astro";
import { Image } from "astro:assets";

export async function getStaticPaths() {
  const photos = await getCollection("photos");

  const paths = Object.values(photos).map((p) => {
    return {
      params: {
        id: p.id,
      },
      props: {
        p,
      },
    };
  });

  return paths;
}
const { p } = Astro.props;

let fmt = (date: Date): string => {
  let year = new Intl.DateTimeFormat("en", { year: "numeric" }).format(date);
  let month = new Intl.DateTimeFormat("en", { month: "short" }).format(date);
  let day = new Intl.DateTimeFormat("en", { day: "2-digit" }).format(date);
  return `${day} ${month} ${year}`;
};
---

<Layout title=`photo: ${p.data.description}`>
  <div class="flex max-h-full flex-col">
    <div class="flex w-full flex-col m-2 items-center justify-center">
      <div
        class="flex w-full flex-col md:flex-row m-2 items-center justify-center"
      >
      <p class="font-bold text-sm md:text-base text-slate-700">{p.data.description}</p>
      <div class="h-full md:border-l-2 md:border-slate-900 mx-2"></div>
        <p class="text-sm md:text-base text-slate-700">
          {fmt(p.data.date)},&nbsp;<span
            class="italic text-sm md:text-base text-slate-700"
            >{p.data.location}</span>
        </p>
      </div>
    </div>
    <div class="flex max-h-full flex-col">
      <Image
        src={p.data.img}
        alt={p.data.description}
        class="object-scale-down"
        style="max-height: 85%;"
      />
    </div>
  </div>
</Layout>
